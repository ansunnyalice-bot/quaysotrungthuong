<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lucky Guess Game</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            background: #0f0c29;
            color: white;
            font-family: 'Segoe UI', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }
        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            width: 350px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border-radius: 8px;
            border: none;
            background: rgba(0,0,0,0.3);
            color: white;
            box-sizing: border-box;
        }
        button {
            width: 100%;
            padding: 12px;
            background: #e94560;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }
        #admin-panel, #user-panel { display: none; }
        .user-row {
            display: flex;
            justify-content: space-between;
            padding: 5px;
            border-bottom: 1px solid #444;
        }
    </style>
</head>
<body>

    <div id="login-screen" class="card">
        <h2>ĐĂNG NHẬP</h2>
        <input type="text" id="nameInput" placeholder="Nhập tên của bạn...">
        <button onclick="login()">VÀO PHÒNG</button>
    </div>

    <div id="user-panel" class="card">
        <h3>Chào <span id="u-name"></span>!</h3>
        <p>Chọn số may mắn (1-100):</p>
        <input type="number" id="userGuess" min="1" max="100">
        <button onclick="sendGuess()">GỬI SỐ</button>
        <p id="msg"></p>
    </div>

    <div id="admin-panel" class="card">
        <h2 style="color: #fcc419;">ADMIN CONTROL</h2>
        <div style="margin-bottom: 10px;">
            Số trúng: <input type="number" id="winNum" value="50" style="width: 60px;">
        </div>
        <div id="monitor" style="text-align: left; margin: 15px 0;"></div>
        <button onclick="checkResult()">CÔNG BỐ KẾT QUẢ</button>
    </div>

    <script>
        let db = JSON.parse(localStorage.getItem('gameDB')) || {};
        let myName = "";

        function login() {
            const name = document.getElementById('nameInput').value.trim();
            if(!name) return;
            myName = name;
            document.getElementById('login-screen').style.display = 'none';
            if(name.toLowerCase() === 'admin') {
                document.getElementById('admin-panel').style.display = 'block';
                showAdminData();
            } else {
                document.getElementById('user-panel').style.display = 'block';
                document.getElementById('u-name').innerText = name;
            }
        }

        function sendGuess() {
            const val = parseInt(document.getElementById('userGuess').value);
            if(isNaN(val) || val < 1) return alert("Không được để trống hoặc nhập số âm!");
            db[myName] = val;
            localStorage.setItem('gameDB', JSON.stringify(db));
            document.getElementById('msg').innerText = "Đã lưu số: " + val;
        }

        function showAdminData() {
            const monitor = document.getElementById('monitor');
            let html = "<b>Người chơi đã chọn:</b><br>";
            for(let u in db) {
                html += `<div class='user-row'><span>${u}</span> <b>${db[u]}</b></div>`;
            }
            monitor.innerHTML = html;
        }

        function checkResult() {
            const win = parseInt(document.getElementById('winNum').value);
            let winners = [];
            for(let u in db) { if(db[u] === win) winners.push(u); }
            alert(winners.length ? "Người thắng: " + winners.join(", ") : "Không ai trúng số " + win);
        }

        // Cập nhật dữ liệu admin mỗi giây
        setInterval(() => { if(myName.toLowerCase()==='admin') showAdminData(); }, 1000);
    </script>
</body>
</html>
